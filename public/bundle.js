var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function r(t){return"function"==typeof t}function s(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function i(t,n){t.appendChild(n)}function a(t,n,e){t.insertBefore(n,e||null)}function l(t){t.parentNode.removeChild(t)}function u(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function c(t){return document.createElement(t)}function h(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function d(){return f("")}function g(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function v(t,n,e){null==e?t.removeAttribute(n):t.setAttribute(n,e)}function m(t,n){n=""+n,t.data!==n&&(t.data=n)}function w(t,n,e,o){t.style.setProperty(n,e,o?"important":"")}class ${constructor(t,n=null){this.e=c("div"),this.a=n,this.u(t)}m(t,n=null){for(let e=0;e<this.n.length;e+=1)a(t,this.n[e],n);this.t=t}u(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}p(t){this.d(),this.u(t),this.m(this.t,this.a)}d(){this.n.forEach(l)}}let b;function y(t){b=t}function x(){if(!b)throw new Error("Function called outside component initialization");return b}function B(t){x().$$.on_mount.push(t)}function E(){const t=b;return(n,e)=>{const o=t.$$.callbacks[n];if(o){const r=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);o.slice().forEach(n=>{n.call(t,r)})}}}const P=[],k=[],S=[],A=[],_=Promise.resolve();let M=!1;function C(t){S.push(t)}function O(){const t=new Set;do{for(;P.length;){const t=P.shift();y(t),j(t.$$)}for(;k.length;)k.pop()();for(let n=0;n<S.length;n+=1){const e=S[n];t.has(e)||(e(),t.add(e))}S.length=0}while(P.length);for(;A.length;)A.pop()();M=!1}function j(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(C))}const V=new Set;let T;function N(t,n){t&&t.i&&(V.delete(t),t.i(n))}function z(t,n,e,o){if(t&&t.o){if(V.has(t))return;V.add(t),T.c.push(()=>{V.delete(t),o&&(e&&t.d(1),o())}),t.o(n)}}function L(t,e,s){const{fragment:i,on_mount:a,on_destroy:l,after_update:u}=t.$$;i.m(e,s),C(()=>{const e=a.map(n).filter(r);l?l.push(...e):o(e),t.$$.on_mount=[]}),u.forEach(C)}function H(t,n){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function G(t,n){t.$$.dirty||(P.push(t),M||(M=!0,_.then(O)),t.$$.dirty=e()),t.$$.dirty[n]=!0}function D(n,r,s,i,a,l){const u=b;y(n);const c=r.props||{},h=n.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:e(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:e(),dirty:null};let f=!1;h.ctx=s?s(n,c,(t,e,o=e)=>(h.ctx&&a(h.ctx[t],h.ctx[t]=o)&&(h.bound[t]&&h.bound[t](o),f&&G(n,t)),e)):c,h.update(),f=!0,o(h.before_update),h.fragment=i(h.ctx),r.target&&(r.hydrate?h.fragment.l(function(t){return Array.from(t.childNodes)}(r.target)):h.fragment.c(),r.intro&&N(n.$$.fragment),L(n,r.target,r.anchor),O()),y(u)}class I{$destroy(){H(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}function R(t){return t>=10?t.toString():`0${t}`}function W(t){return`${R(Math.floor(t/1e3/60))}:${R(Math.floor(t/1e3)%60)}.${Math.floor(t/10).toString().slice(-2)}`}function F(n){var e,o,r,s,u,c,p,d,g,$,b,y,x,B,E,P,k=W(n.lapse)+"";return{c(){e=h("svg"),o=h("g"),r=h("circle"),s=h("use"),u=h("g"),c=h("g"),p=h("path"),g=h("g"),$=h("g"),b=h("path"),x=h("circle"),B=h("circle"),E=h("text"),P=f(k),v(r,"id","dial"),v(r,"cx","0"),v(r,"cy","0"),v(r,"r","37.8"),v(r,"fill","none"),v(r,"stroke","currentColor"),v(r,"stroke-width","5"),v(r,"stroke-dasharray","0.27 1.7082"),v(s,"href","#dial"),v(s,"transform","scale(-1 1)"),v(p,"d","M -2.25 0 h 4.5 l -2.25 2.5 l -2.25 -2.5"),v(p,"fill","currentColor"),v(p,"stroke","currentColor"),v(p,"stroke-width","1"),v(p,"stroke-linejoin","round"),v(p,"stroke-linecap","round"),v(c,"transform","translate(0 -45)"),v(u,"transform",d="rotate("+n.rotation+")"),v(b,"d","M 0 -1 v -7.5"),v(b,"fill","none"),v(b,"stroke","currentColor"),v(b,"stroke-width","0.4"),v(b,"stroke-linejoin","round"),v(b,"stroke-linecap","round"),v($,"transform",y="rotate("+60*n.rotation%360+")"),v(x,"r","9"),v(x,"fill","none"),v(x,"stroke","currentColor"),v(x,"stroke-width","0.4"),v(B,"r","1"),v(B,"fill","none"),v(B,"stroke","currentColor"),v(B,"stroke-width","0.4"),v(g,"transform","translate(0 20)"),v(E,"text-anchor","middle"),v(E,"fill","currentColor"),v(E,"dominant-baseline","middle"),v(E,"font-size","10"),w(E,"font-weight","300"),w(E,"letter-spacing","1px"),v(o,"transform","translate(50 50)"),v(e,"viewBox","0 0 100 100"),v(e,"width","300"),v(e,"height","300"),v(e,"class","svelte-1ff0jg8")},m(t,l){a(t,e,l),i(e,o),i(o,r),i(o,s),i(o,u),i(u,c),i(c,p),n.g1_binding(u),i(o,g),i(g,$),i($,b),n.g2_binding($),i(g,x),i(g,B),i(o,E),i(E,P)},p(t,n){t.rotation&&d!==(d="rotate("+n.rotation+")")&&v(u,"transform",d),t.rotation&&y!==(y="rotate("+60*n.rotation%360+")")&&v($,"transform",y),t.lapse&&k!==(k=W(n.lapse)+"")&&m(P,k)},i:t,o:t,d(t){t&&l(e),n.g1_binding(null),n.g2_binding(null)}}}function q(t,n,e){let o,r,s,i,{lapse:a=0}=n;return t.$set=t=>{"lapse"in t&&e("lapse",a=t.lapse)},t.$$.update=(t={lapse:1,minutes:1,seconds:1,transitioned:1})=>{t.lapse&&e("rotation",i=a/1e3/60*360%360),(t.lapse||t.minutes||t.seconds)&&!a&&r&&o&&(e("minutes",r.style.transition="transform 0.2s ease-in-out",r),e("seconds",o.style.transition="transform 0.2s ease-in-out",o),e("transitioned",s=!1)),(t.lapse||t.transitioned)&&a&&!s&&(e("minutes",r.style.transition="none",r),e("seconds",o.style.transition="none",o),e("transitioned",s=!0))},{lapse:a,seconds:o,minutes:r,rotation:i,g1_binding:function(t){k[t?"unshift":"push"](()=>{e("minutes",r=t)})},g2_binding:function(t){k[t?"unshift":"push"](()=>{e("seconds",o=t)})}}}class J extends I{constructor(t){super(),D(this,t,q,F,s,["lapse"])}}const K=[];function Q(n,e=t){let o;const r=[];function i(t){if(s(n,t)&&(n=t,o)){const t=!K.length;for(let t=0;t<r.length;t+=1){const e=r[t];e[1](),K.push(e,n)}if(t){for(let t=0;t<K.length;t+=2)K[t][0](K[t+1]);K.length=0}}}return{set:i,update:function(t){i(t(n))},subscribe:function(s,a=t){const l=[s,a];return r.push(l),1===r.length&&(o=e(i)||t),s(n),()=>{const t=r.indexOf(l);-1!==t&&r.splice(t,1),0===r.length&&(o(),o=null)}}}}const U={subscribe:Q(0,(function(t){const n=(new Date).getTime(),e=setInterval(()=>{const e=(new Date).getTime();t(e-n)},10);return function(){t(0),clearInterval(e)}})).subscribe};function X(t){var n,e,o=new J({props:{lapse:t.lapse}});return{c(){n=c("div"),o.$$.fragment.c(),v(n,"class","stopwatch")},m(t,r){a(t,n,r),L(o,n,null),e=!0},p(t,n){var e={};t.lapse&&(e.lapse=n.lapse),o.$set(e)},i(t){e||(N(o.$$.fragment,t),e=!0)},o(t){z(o.$$.fragment,t),e=!1},d(t){t&&l(n),H(o)}}}function Y(t,n,e){let o,{running:r=!1}=n,s=0;function i(){o&&(o(),e("unsubscribe",o=null))}var a;return a=()=>{i()},x().$$.on_destroy.push(a),t.$set=t=>{"running"in t&&e("running",r=t.running)},t.$$.update=(t={running:1,unsubscribe:1})=>{t.running&&(r?(e("lapse",s=0),i(),e("unsubscribe",o=U.subscribe(t=>{e("lapse",s=t)}))):i()),t.unsubscribe},{running:r,lapse:s}}class Z extends I{constructor(t){super(),D(this,t,Y,X,s,["running"])}}const tt=Q(0);function nt(t){return parseInt(Math.random()*t)}const et=30,ot=.9,rt=.1,st=20;function it(t){return tt.update(t=>t+1),t}const at=t=>it(function(t){return t.reverse()}(t)),lt=t=>it(function(t){let n,e;do{n=nt(t.length-2),e=nt(t.length)}while(n>=e);for(var o=0,r=e-n+1>>1;o<r;o++)t.swap(n+o,e-o);return t}(t)),ut=t=>it(function(t){var n,e;do{n=nt(t.length>>1),e=nt(t.length)}while(n>=e);var o=t.slice(0,n),r=t.slice(n,e),s=t.slice(e,t.length);return r.concat(o).concat(s).clone()}(t));function ct(t,n,e,o){let r=e.clone(),s=ht("next",t,n,r,o),i=ht("previous",t,n,r,o);return r[t]=s,r[n]=i,r}function ht(t,n,e,o,r){let s,i,a=new Array,l=o[n].clone(),u=o[e].clone(),c=l[nt(l.length)];for(a.push(c);l.length>1;)s=l[t](l.indexOf(c)),i=u[t](u.indexOf(c)),l.deleteByValue(c),u.deleteByValue(c),c=r[c][s]<r[c][i]?s:i,a.push(c);return a}function ft(t=[]){const n=Math.random();return t.forEach((t,e)=>{if(n<=t)return e}),0}function pt(t,n,e){const o=Object.create(t);return o.item=n[e],o}function dt(t){var n,e,o=t.item.toString()+"";return{c(){n=c("p"),e=f(o)},m(t,o){a(t,n,o),i(n,e)},p(t,n){t.population&&o!==(o=n.item.toString()+"")&&m(e,o)},d(t){t&&l(n)}}}function gt(t){var n,e,o,r,s,h,d,w,$,b,y,x,B,E,P,k,S,A,_,M,C,O,j,V,T,G,D,I,R,W,F,q,J,K,Q,U,X,Y,tt,nt,et,ot,rt,st,it,at,lt,ut,ct,ht,ft,gt,vt,mt,wt,$t,bt,yt=t.graph.nodes().length+"",xt=t.iterators.currentGeneration+"",Bt=t.currentBest.bestValue+"",Et=t.best.toString()+"",Pt=t.population[t.currentBest.bestPosition]&&t.population[t.currentBest.bestPosition].toString()+"",kt=new Z({props:{running:t.running}});let St=t.population,At=[];for(let n=0;n<St.length;n+=1)At[n]=dt(pt(t,St,n));return{c(){n=c("div"),(e=c("button")).textContent="Start/Stop",o=p(),r=c("div"),s=c("div"),h=c("div"),kt.$$.fragment.c(),d=p(),w=c("div"),($=c("div")).textContent="Stations:",b=p(),y=c("div"),x=f(yt),B=p(),E=c("div"),(P=c("div")).textContent="Generation:",k=p(),S=c("div"),A=f(xt),_=p(),M=c("div"),(C=c("div")).textContent="Mutations:",O=p(),j=c("div"),V=f(t.count_value),T=p(),G=c("div"),(D=c("div")).textContent="Best value:",I=p(),R=c("div"),W=f(t.bestValue),F=p(),q=c("div"),(J=c("div")).textContent="Best in population:",K=p(),Q=c("div"),U=f(Bt),X=p(),Y=c("div"),tt=c("div"),(nt=c("div")).textContent="Best path:",et=p(),ot=c("div"),rt=f(Et),st=p(),it=c("div"),(at=c("div")).textContent="Best path in current population:",lt=p(),ut=c("div"),ct=c("p"),ht=f(Pt),ft=p(),gt=c("div"),(vt=c("div")).textContent="Population:",mt=p(),wt=c("div");for(let t=0;t<At.length;t+=1)At[t].c();v(e,"class","startButton svelte-11xn333"),v(h,"class","stopWatch svelte-11xn333"),v($,"class","label"),v(y,"class","value svelte-11xn333"),v(w,"class","row svelte-11xn333"),v(P,"class","label"),v(S,"class","value svelte-11xn333"),v(E,"class","row svelte-11xn333"),v(C,"class","label"),v(j,"class","value svelte-11xn333"),v(M,"class","row svelte-11xn333"),v(D,"class","label"),v(R,"class","value svelte-11xn333"),v(G,"class","row svelte-11xn333"),v(J,"class","label"),v(Q,"class","value svelte-11xn333"),v(q,"class","row svelte-11xn333"),v(s,"class","table svelte-11xn333"),v(nt,"class","label-row svelte-11xn333"),v(ot,"class","value-row svelte-11xn333"),v(at,"class","label-row svelte-11xn333"),v(ut,"class","value-row svelte-11xn333"),v(vt,"class","label-row svelte-11xn333"),v(wt,"class","value-row svelte-11xn333"),v(Y,"class","paths"),v(r,"class","info svelte-11xn333"),v(n,"class","calculateBlock"),bt=g(e,"click",t.onStartOrStop)},m(t,l){a(t,n,l),i(n,e),i(n,o),i(n,r),i(r,s),i(s,h),L(kt,h,null),i(s,d),i(s,w),i(w,$),i(w,b),i(w,y),i(y,x),i(s,B),i(s,E),i(E,P),i(E,k),i(E,S),i(S,A),i(s,_),i(s,M),i(M,C),i(M,O),i(M,j),i(j,V),i(s,T),i(s,G),i(G,D),i(G,I),i(G,R),i(R,W),i(s,F),i(s,q),i(q,J),i(q,K),i(q,Q),i(Q,U),i(r,X),i(r,Y),i(Y,tt),i(tt,nt),i(tt,et),i(tt,ot),i(ot,rt),i(Y,st),i(Y,it),i(it,at),i(it,lt),i(it,ut),i(ut,ct),i(ct,ht),i(Y,ft),i(Y,gt),i(gt,vt),i(gt,mt),i(gt,wt);for(let t=0;t<At.length;t+=1)At[t].m(wt,null);$t=!0},p(t,n){var e={};if(t.running&&(e.running=n.running),kt.$set(e),$t&&!t.graph||yt===(yt=n.graph.nodes().length+"")||m(x,yt),$t&&!t.iterators||xt===(xt=n.iterators.currentGeneration+"")||m(A,xt),$t&&!t.count_value||m(V,n.count_value),$t&&!t.bestValue||m(W,n.bestValue),$t&&!t.currentBest||Bt===(Bt=n.currentBest.bestValue+"")||m(U,Bt),$t&&!t.best||Et===(Et=n.best.toString()+"")||m(rt,Et),$t&&!t.population&&!t.currentBest||Pt===(Pt=n.population[n.currentBest.bestPosition]&&n.population[n.currentBest.bestPosition].toString()+"")||m(ht,Pt),t.population){let e;for(St=n.population,e=0;e<St.length;e+=1){const o=pt(n,St,e);At[e]?At[e].p(t,o):(At[e]=dt(o),At[e].c(),At[e].m(wt,null))}for(;e<At.length;e+=1)At[e].d(1);At.length=St.length}},i(t){$t||(N(kt.$$.fragment,t),$t=!0)},o(t){z(kt.$$.fragment,t),$t=!1},d(t){t&&l(n),H(kt),u(At,t),bt()}}}function vt(t,n,e){const o=E();let r,s,i,a,{graph:l,stationsBetween:u,dis:c}=n,h=!1,f={},p=[],d={},g=[];tt.subscribe(t=>{e("count_value",a=t)});function v(){e("iterators",f.currentGeneration++,f),e("population",g=function(t,n,e,o){let r=t.clone(),s=new Array;s.push(r[n.bestPosition]),s.push(lt(e.clone())),s.push(ut(e.clone())),s.push(at(e.clone())),s.push(e.clone());const i=function(t=[]){const n=t.map(t=>1/t),e=n.reduce((t,n)=>t+=n);let o;return n.map(t=>t/e).map(t=>o=(o||0)+t)}(o);for(let t=5;t<et;t++)s.push(r[ft(i)]);return r=s}(g,d,p,i)),e("population",g=function(t,n){let e=new Array;for(let t=0;t<et;t++)Math.random()<ot&&e.push(t);e.shuffle();for(let o=0,r=e.length-1;o<r;o+=2)t=ct(e[o],e[o+1],t,n);return t}(g,c)),e("population",g=function(t){let n=t.clone();for(let e=0;e<et;e++)Math.random()<rt&&(Math.random()>.5?n[e]=lt(t[e]):n[e]=ut(t[e]),e--);return n}(g)),m(),w=`<p>\n      There are ${l.nodes().length} stations in the map. \n      The ${f.currentGeneration}th generation \n      with ${a} times of mutation. \n      Best value: ${~~s} -- ${d.bestValue}. \n      Path: ${p.toString()}</p>`}function m(){i=g.map(t=>(function(t,n){return t.reduce((t,e,o,r)=>t+=n[e][r[o-1]])})(t,c)),e("currentBest",d=function(t){const n=t.min();return{bestValue:n,bestPosition:t.indexOf(n)}}(i)),(void 0===s||s>d.bestValue)&&(e("best",p=g[d.bestPosition].clone()),e("bestValue",s=d.bestValue))}let w;return t.$set=t=>{"graph"in t&&e("graph",l=t.graph),"stationsBetween"in t&&e("stationsBetween",u=t.stationsBetween),"dis"in t&&e("dis",c=t.dis)},w="",{graph:l,stationsBetween:u,dis:c,running:h,iterators:f,bestValue:s,best:p,currentBest:d,population:g,count_value:a,onStartOrStop:function(){return h?(clearInterval(r),o("getResult",{result:p}),e("running",h=!1)):(e("iterators",f={currentGeneration:0}),e("bestValue",s=void 0),e("best",p=[]),e("currentBest",d=0),e("population",g=[]),i=new Array(et),function(){const t=l.nodes().length;e("population",g=Array.apply(null,Array(et)).map(n=>(function(t){return Array.from(Array(t).keys()).shuffle()})(t))),m()}(),r=setInterval(v,st),e("running",h=!0))}}}class mt extends I{constructor(t){super(),D(this,t,vt,gt,s,["graph","stationsBetween","dis"])}}function wt(t,n,e){const o=Object.create(t);return o.station=n[e],o.index=e,o}function $t(t,n,e){const o=Object.create(t);return o.station=n[e],o.index=e,o}function bt(t){var n,e,o;let r=t.stationsPath,s=[];for(let n=0;n<r.length;n+=1)s[n]=xt($t(t,r,n));var h=t.showScheme&&Bt(t);return{c(){n=c("div"),e=c("aside");for(let t=0;t<s.length;t+=1)s[t].c();o=p(),h&&h.c(),v(e,"class","svelte-1vwv11y"),v(n,"class","container svelte-1vwv11y")},m(t,r){a(t,n,r),i(n,e);for(let t=0;t<s.length;t+=1)s[t].m(e,null);i(n,o),h&&h.m(n,null)},p(t,o){if(t.stationsPath){let n;for(r=o.stationsPath,n=0;n<r.length;n+=1){const i=$t(o,r,n);s[n]?s[n].p(t,i):(s[n]=xt(i),s[n].c(),s[n].m(e,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=r.length}o.showScheme?h?h.p(t,o):((h=Bt(o)).c(),h.m(n,null)):h&&(h.d(1),h=null)},d(t){t&&l(n),u(s,t),h&&h.d()}}}function yt(t){var n,e,o,r,s=t.station.text+"";function u(){return t.mouseover_handler(t)}return{c(){n=c("div"),o=p(),e=new $(s,o),r=g(n,"mouseover",u)},m(t,r){a(t,n,r),e.m(n),i(n,o)},p(n,o){t=o,n.stationsPath&&s!==(s=t.station.text+"")&&e.p(s)},d(t){t&&l(n),r()}}}function xt(t){var n,e=t.station&&yt(t);return{c(){e&&e.c(),n=d()},m(t,o){e&&e.m(t,o),a(t,n,o)},p(t,o){o.station?e?e.p(t,o):((e=yt(o)).c(),e.m(n.parentNode,n)):e&&(e.d(1),e=null)},d(t){e&&e.d(t),t&&l(n)}}}function Bt(t){var n,e,o,r,s,u,c,p,d,g,m,w,$,b,y,x,B,E,P,k=t.resultPath.length&&Et(t);return{c(){n=h("svg"),e=h("defs"),o=h("symbol"),r=h("path"),s=h("path"),u=h("path"),c=h("g"),p=h("text"),d=f("Холодногірсько-заводська лінія\n      "),g=h("text"),m=f("Салтівська лінія\n      "),w=h("text"),$=f("Олексіївська лінія\n      "),b=h("g"),k&&k.c(),y=h("g"),x=h("text"),B=f("Державiнська"),E=h("text"),P=f("Одеська"),v(r,"fill","#fff"),v(r,"d","M6.6 11.5a4.9 4.9 0 110-9.8A4.8 4.8 0 019.7 3a9.7 9.7 0 004.5\n          2v3.5a9.7 9.7 0 00-3.9 1.6l-.9.6a4.8 4.8 0 01-2.8 1z"),v(s,"d","M6.7 3.5a3 3 0 012 .7 11.5 11.5 0 003.7 2V7a11.4 11.4 0 00-3.1\n          1.6l-.9.6a3 3 0 01-1.8.6 3.1 3.1 0 110-6.3m0-3.5A6.6 6.6 0 000 6.6a6.6\n          6.6 0 006.6 6.7 6.5 6.5 0 003.8-1.3l.9-.6a8 8 0 014.6-1.4V3.3a8 8 0\n          01-5-1.8A6.5 6.5 0 006.6 0z"),v(o,"id","w"),v(u,"fill","none"),v(u,"stroke",t.colors.green),v(u,"stroke-width","3"),v(u,"d","M747 1310l-18-18-241 241a72 72 0 00-21 51v85h-15v21h56v-21h-16v-85a47\n      47 0 0114-34l46-45 12 12 15-15-12-12z"),v(p,"fill",t.colors.red),v(p,"transform","rotate(-90 1562.5 515.7)"),v(g,"fill",t.colors.blue),v(g,"transform","rotate(-90 700.6 -347.6)"),v(w,"fill",t.colors.green),v(w,"transform","rotate(-90 415.7 -32.8)"),v(c,"font-size","34"),v(b,"fill",t.colors.text),v(b,"font-size","53"),v(x,"transform","translate(573 1556)"),v(E,"transform","translate(519 1690)"),v(y,"fill",t.colors.textDisable),v(y,"font-size","53"),v(n,"xmlns","http://www.w3.org/2000/svg"),v(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),v(n,"class","map svelte-1vwv11y"),v(n,"font-family","Tahoma"),v(n,"viewBox","0 0 1501 2151")},m(t,l){a(t,n,l),i(n,e),i(e,o),i(o,r),i(o,s),i(n,u),i(n,c),i(c,p),i(p,d),i(c,g),i(g,m),i(c,w),i(w,$),i(n,b),k&&k.m(b,null),i(n,y),i(y,x),i(x,B),i(y,E),i(E,P)},p(t,n){n.resultPath.length?k?k.p(t,n):((k=Et(n)).c(),k.m(b,null)):k&&(k.d(1),k=null)},d(t){t&&l(n),k&&k.d()}}}function Et(t){var n;let e=t.stationsPath,o=[];for(let n=0;n<e.length;n+=1)o[n]=kt(wt(t,e,n));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=d()},m(t,e){for(let n=0;n<o.length;n+=1)o[n].m(t,e);a(t,n,e)},p(t,r){if(t.stationsPath||t.showingStation||t.colors){let s;for(e=r.stationsPath,s=0;s<e.length;s+=1){const i=wt(r,e,s);o[s]?o[s].p(t,i):(o[s]=kt(i),o[s].c(),o[s].m(n.parentNode,n))}for(;s<o.length;s+=1)o[s].d(1);o.length=e.length}},d(t){u(o,t),t&&l(n)}}}function Pt(t){var n,e,o,r,s,u,c,f,p,d=t.station.path+"",g=t.station.stop+"",m=t.station.text+"";return{c(){n=h("g"),e=h("g"),o=h("g"),s=h("g"),c=h("text"),v(o,"stroke",r=t.colors[t.station.color]),v(e,"fill","none"),v(e,"stroke-miterlimit","10"),v(e,"stroke-width","28"),v(s,"fill",u=t.colors[t.station.color]),v(c,"style",f=t.station.style),v(n,"class",p="fadein "+(t.showingStation===t.index?"lel":"")+" svelte-1vwv11y"),w(n,"animation-delay",t.index/30*10+"s")},m(t,r){a(t,n,r),i(n,e),i(e,o),o.innerHTML=d,i(n,s),s.innerHTML=g,i(n,c),c.innerHTML=m},p(t,e){t.stationsPath&&d!==(d=e.station.path+"")&&(o.innerHTML=d),t.stationsPath&&r!==(r=e.colors[e.station.color])&&v(o,"stroke",r),t.stationsPath&&g!==(g=e.station.stop+"")&&(s.innerHTML=g),t.stationsPath&&u!==(u=e.colors[e.station.color])&&v(s,"fill",u),t.stationsPath&&m!==(m=e.station.text+"")&&(c.innerHTML=m),t.stationsPath&&f!==(f=e.station.style)&&v(c,"style",f),t.showingStation&&p!==(p="fadein "+(e.showingStation===e.index?"lel":"")+" svelte-1vwv11y")&&v(n,"class",p)},d(t){t&&l(n)}}}function kt(t){var n,e=t.station&&Pt(t);return{c(){e&&e.c(),n=d()},m(t,o){e&&e.m(t,o),a(t,n,o)},p(t,o){o.station?e?e.p(t,o):((e=Pt(o)).c(),e.m(n.parentNode,n)):e&&(e.d(1),e=null)},d(t){e&&e.d(t),t&&l(n)}}}function St(n){var e,o,r,s,u,h,v,w=n.resultPath&&bt(n);return{c(){e=c("div"),o=f(n.resultPath),r=p(),(s=c("button")).textContent="Show",u=p(),w&&w.c(),h=d(),v=g(s,"click",n.onShow)},m(t,n){a(t,e,n),i(e,o),a(t,r,n),a(t,s,n),a(t,u,n),w&&w.m(t,n),a(t,h,n)},p(t,n){t.resultPath&&m(o,n.resultPath),n.resultPath?w?w.p(t,n):((w=bt(n)).c(),w.m(h.parentNode,h)):w&&(w.d(1),w=null)},i:t,o:t,d(t){t&&(l(e),l(r),l(s),l(u)),w&&w.d(t),t&&l(h),v()}}}function At(t,n,e){let o,{stationsBetween:r,path:s}=n,i=!1,a=[],l=[];function u(t){e("showingStation",c=t)}B(async()=>{const t=await fetch("https://metro.kh.ua/metroapi.php?value=stations"),n=await t.json();o=n});let c;return t.$set=t=>{"stationsBetween"in t&&e("stationsBetween",r=t.stationsBetween),"path"in t&&e("path",s=t.path)},t.$$.update=(t={path:1,stationsBetween:1})=>{(t.path||t.stationsBetween)&&function({path:t=[],stationsBetween:n}){e("stationsPath",l=[]),t&&t.length&&(e("resultPath",a=function({path:t=[],stationsBetween:n}){let e=[];for(let o=1;o<t.length;o++){const r=t[o-1],s=t[o];let i=n[r][s].slice(1);e=e.concat(i)}return e.unshift(t[0]),e}({path:t,stationsBetween:n})),a.map(t=>{l.push(o.find(n=>n.id==t))}))}({path:s,stationsBetween:r})},e("showingStation",c=null),{stationsBetween:r,path:s,showScheme:i,resultPath:a,stationsPath:l,showStation:u,onShow:function(){e("showScheme",i=!0)},colors:{red:"#d22531",blue:"#2060ba",green:"#41a747",text:"#09303b",textDisable:"#9c98a6"},showingStation:c,mouseover_handler:({index:t})=>u(t)}}class _t extends I{constructor(t){super(),D(this,t,At,St,s,["stationsBetween","path"])}}var Mt=function(t){var n={addNode:r,removeNode:function(t){return Object.keys(e).forEach((function(n){e[n].forEach((function(e){e===t&&h(n,e)}))})),delete e[t],n},nodes:s,adjacent:i,addEdge:c,removeEdge:h,setEdgeWeight:l,getEdgeWeight:u,indegree:function(t){var n=0;function o(e){e===t&&n++}return Object.keys(e).forEach((function(t){e[t].forEach(o)})),n},outdegree:function(t){return t in e?e[t].length:0},depthFirstSearch:f,lowestCommonAncestors:function(t,n){var e=[],o=[];(function t(r,s){return!!r[s]||(r[s]=!0,e.push(s),s==n?(o.push(s),!1):i(s).every(n=>t(r,n)))})({},t)&&function t(n,r){n[r]||(n[r]=!0,e.indexOf(r)>=0?o.push(r):0==o.length&&i(r).forEach(e=>{t(n,e)}))}({},n);return o},topologicalSort:function(t,n){return f(t,n).reverse()},shortestPath:function(t,n){var e={},o={},r={};function a(){var t,n=1/0;return Object.keys(r).forEach((function(o){e[o]<n&&(n=e[o],t=o)})),void 0===t?(r={},null):(delete r[t],t)}function l(t,n){var r=u(t,n);e[n]>e[t]+r&&(e[n]=e[t]+r,o[n]=t)}return function(){(function(){if(s().forEach((function(t){e[t]=1/0})),e[t]!==1/0)throw new Error("Source node is not in the graph");if(e[n]!==1/0)throw new Error("Destination node is not in the graph");e[t]=0})(),s().forEach((function(t){r[t]=!0}));for(;0!==Object.keys(r).length;){var o=a();i(o).forEach((function(t){l(o,t)}))}}(),function(){var e=[],r=0,s=n;for(;o[s];)e.push(s),r+=u(o[s],s),s=o[s];if(s!==t)throw new Error("No path found");return e.push(s),e.reverse(),e.weight=r,e}()},serialize:function(){var t={nodes:s().map((function(t){return{id:t}})),links:[]};return t.nodes.forEach((function(n){var e=n.id;i(e).forEach((function(n){t.links.push({source:e,target:n,weight:u(e,n)})}))})),t},deserialize:p},e={},o={};function r(t){return e[t]=i(t),n}function s(){var t={};return Object.keys(e).forEach((function(n){t[n]=!0,e[n].forEach((function(n){t[n]=!0}))})),Object.keys(t)}function i(t){return e[t]||[]}function a(t,n){return t+"|"+n}function l(t,e,r){return o[a(t,e)]=r,n}function u(t,n){var e=o[a(t,n)];return void 0===e?1:e}function c(t,e,o){return r(t),r(e),i(t).push(e),void 0!==o&&l(t,e,o),n}function h(t,o){return e[t]&&(e[t]=i(t).filter((function(t){return t!==o}))),n}function f(t,n){t||(t=s()),"boolean"!=typeof n&&(n=!0);var e={},o=[];function r(t){e[t]||(e[t]=!0,i(t).forEach(r),o.push(t))}return n?t.forEach(r):(t.forEach((function(t){e[t]=!0})),t.forEach((function(t){i(t).forEach(r)}))),o}function p(t){return t.nodes.forEach((function(t){r(t.id)})),t.links.forEach((function(t){c(t.source,t.target,t.weight)})),n}return(t&&p(t),n)};function Ct(t){const n=6;function e(t){return t+n}const o=Mt();t.map(t=>({...t,weight:e(t.weight)})).map(t=>{o.addEdge(t.from,t.to,t.weight),o.addEdge(t.to,t.from,t.weight)});let r=[];o.nodes().map((t,n)=>{r.push([]),o.nodes().map((e,s)=>{const i=o.shortestPath(t,e).slice();r[n].push(i)})}),o.nodes().map((t,n)=>{o.nodes().map((n,e)=>{const r=o.shortestPath(t,n);o.addEdge(t,n,r.weight)})});const s=function(t){const n=t.nodes(),e=n.length;return Array.apply(null,Array(e)).map((o,r)=>Array.apply(null,Array(e)).map((e,o)=>~~t.getEdgeWeight(n[r],n[o])))}(o);return{graph:o,stationsBetween:r,distances:s}}function Ot(t){var n,e=new mt({props:{graph:t.graph,stationsBetween:t.stationsBetween,dis:t.dis}});return e.$on("getResult",t.getResult),{c(){e.$$.fragment.c()},m(t,o){L(e,t,o),n=!0},p(t,n){var o={};t.graph&&(o.graph=n.graph),t.stationsBetween&&(o.stationsBetween=n.stationsBetween),t.dis&&(o.dis=n.dis),e.$set(o)},i(t){n||(N(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function jt(t){var n,e,r,s=t.graph&&t.stationsBetween&&t.dis&&Ot(t),u=new _t({props:{path:t.bestPath,stationsBetween:t.stationsBetween}});return{c(){n=c("div"),s&&s.c(),e=p(),u.$$.fragment.c(),v(n,"class","lol")},m(t,o){a(t,n,o),s&&s.m(n,null),i(n,e),L(u,n,null),r=!0},p(t,r){r.graph&&r.stationsBetween&&r.dis?s?(s.p(t,r),N(s,1)):((s=Ot(r)).c(),N(s,1),s.m(n,e)):s&&(T={r:0,c:[],p:T},z(s,1,1,()=>{s=null}),T.r||o(T.c),T=T.p);var i={};t.bestPath&&(i.path=r.bestPath),t.stationsBetween&&(i.stationsBetween=r.stationsBetween),u.$set(i)},i(t){r||(N(s),N(u.$$.fragment,t),r=!0)},o(t){z(s),z(u.$$.fragment,t),r=!1},d(t){t&&l(n),s&&s.d(),H(u)}}}function Vt(t,n,e){let o,r,s,i;return B(async()=>{const t=await fetch("https://metro.kh.ua/metroapi.php?value=path"),n=Ct(await t.json());e("graph",o=n.graph),e("stationsBetween",r=n.stationsBetween),e("dis",s=n.distances)}),{graph:o,stationsBetween:r,dis:s,bestPath:i,getResult:function(t){e("bestPath",i=t.detail.result)}}}class Tt extends I{constructor(t){super(),D(this,t,Vt,jt,s,[])}}function Nt(n){var e,o=new Tt({});return{c(){o.$$.fragment.c()},m(t,n){L(o,t,n),e=!0},p:t,i(t){e||(N(o.$$.fragment,t),e=!0)},o(t){z(o.$$.fragment,t),e=!1},d(t){H(o,t)}}}function zt(t){return Array.prototype.clone=function(){return this.slice(0)},Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)},Array.prototype.shuffle=function(){for(var t,n,e=this.length-1;e;t=nt(e),n=this[--e],this[e]=this[t],this[t]=n);return this},Array.prototype.indexOf=function(t){for(var n=0;n<this.length;n++)if(this[n]===t)return n},Array.prototype.deleteByValue=function(t){var n=this.indexOf(t);this.splice(n,1)},Array.prototype.next=function(t){return t===this.length-1?this[0]:this[t+1]},Array.prototype.previous=function(t){return 0===t?this[this.length-1]:this[t-1]},Array.prototype.swap=function(t,n){if(!(t>this.length||n>this.length||t===n)){var e=this[t];this[t]=this[n],this[n]=e}},Array.prototype.roll=function(){for(var t=nt(this.length),n=[],e=t;e<this.length;e++)n.push(this[e]);for(e=0;e<t;e++)n.push(this[e]);return n},{}}return new class extends I{constructor(t){super(),D(this,t,zt,Nt,s,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
